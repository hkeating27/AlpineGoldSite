<!DOCTYPE html>
<html>
<head>
  <title>Referral Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, button { margin: 5px 0; display: block; }
  </style>
</head>
<body>
  <h2>Referral Form</h2>
  <label>First Name:</label>
  <input type="text" id="first_name" required>

  <label>Last Name:</label>
  <input type="text" id="last_name" required>

  <label>Referred By:</label>
  <input type="text" id="referred_by" placeholder="Referred By">

  <button onclick="submitForm()">Submit</button>

  <br>
  <a href="referrals.html">See Referrals List</a>

<script>
  // grab the input
  const refInput = document.getElementById('referred_by');

  // read the URL param
  const params = new URLSearchParams(window.location.search);
  const ref = params.get('ref');

  if (ref) {
    // if there *is* a ref= in the URL, fill and lock the field
    refInput.value = ref;
    refInput.readOnly = true;
  } else {
    // otherwise leave it empty and editable
    refInput.placeholder = 'Type who referred you';
  }

  function submitForm() {
    const data = {
      first_name: document.getElementById('first_name').value,
      last_name: document.getElementById('last_name').value,
      referred_by: refInput.value
    };

    fetch('/add', {  // since you're on Render, this is same-origin
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(r => r.text())
    .then(msg => alert(msg))
    .catch(e => { console.error(e); alert('Submit failed'); });
  }
</script>
</body>
</html>
